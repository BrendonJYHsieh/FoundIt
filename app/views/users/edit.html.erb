<!DOCTYPE html>
<html>
  <head>
    <title>Edit Profile - FoundIt</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background: #f5f5f5;
        color: #333;
      }

      .container {
        max-width: 800px;
        margin: 40px auto;
        padding: 0 20px;
      }

      h1 {
        text-align: center;
        color: #2E5BBA;
        font-size: 2rem;
        margin-bottom: 10px;
      }

      p.subtitle {
        text-align: center;
        font-size: 1.1rem;
        color: #666;
        margin-bottom: 30px;
      }

      form {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 1px solid #e0e0e0;
      }

      .form-section {
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid #e0e0e0;
      }

      .form-section:last-child {
        border-bottom: none;
      }

      .form-section h3 {
        color: #2E5BBA;
        margin: 0 0 20px 0;
        font-size: 1.3rem;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2E5BBA;
      }

      input, textarea, select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 8px;
        margin-bottom: 20px;
        font-size: 1rem;
        transition: border 0.2s ease;
        box-sizing: border-box;
      }

      input:focus, textarea:focus, select:focus {
        border-color: #2E5BBA;
        box-shadow: 0 0 0 2px rgba(46, 91, 186, 0.1);
        outline: none;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .btn {
        display: inline-block;
        background: #2E5BBA;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        font-weight: bold;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 5px;
      }

      .btn:hover {
        background: #1E4A9A;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(46, 91, 186, 0.3);
      }

      .btn-secondary {
        background: #6c757d;
      }

      .btn-secondary:hover {
        background: #5a6268;
      }

      .btn-danger {
        background: #dc3545;
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .back-link {
        text-align: center;
        margin-top: 25px;
      }

      .back-link a {
        color: #2E5BBA;
        text-decoration: none;
        font-weight: bold;
      }

      .back-link a:hover {
        text-decoration: underline;
      }

      .error-messages {
        background: #ffeaea;
        border: 1px solid #ffcdd2;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
      }

      .error-messages h3 {
        color: #b71c1c;
        margin: 0 0 10px 0;
        font-size: 1rem;
      }

      .error-messages ul {
        margin: 0;
        padding-left: 20px;
        color: #b71c1c;
      }

      .error-messages li {
        margin-bottom: 5px;
      }

      .help-text {
        font-size: 0.9rem;
        color: #666;
        margin-top: -15px;
        margin-bottom: 20px;
      }

      .readonly-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .readonly-section h3 {
        color: #2E5BBA;
        margin: 0 0 15px 0;
        font-size: 1.2rem;
      }

      .readonly-field {
        margin-bottom: 15px;
      }

      .readonly-field label {
        color: #666;
        font-weight: normal;
        margin-bottom: 5px;
      }

      .readonly-field p {
        margin: 0;
        color: #333;
        font-weight: bold;
      }

      .readonly-field small {
        color: #666;
        font-size: 0.8rem;
      }

      .button-group {
        text-align: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #e0e0e0;
      }

      @media (max-width: 768px) {
        .form-row {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>‚úèÔ∏è Edit Profile</h1>
      <p class="subtitle">Update your personal information and preferences</p>

      <%= form_with model: @user, local: true, data: { turbo: false }, multipart: true do |form| %>
        <% if @user.errors.any? %>
          <div class="error-messages">
            <h3>
              <%= pluralize(@user.errors.count, "error") %> prohibited this profile from being saved:
            </h3>
            <ul>
              <% @user.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <!-- Personal Information -->
        <div class="form-section">
          <h3>üë§ Personal Information</h3>
          
          <div class="form-row">
            <div>
              <%= form.label :first_name, "First Name" %>
              <%= form.text_field :first_name, 
                  placeholder: "Enter your first name",
                  required: true %>
            </div>
            
            <div>
              <%= form.label :last_name, "Last Name" %>
              <%= form.text_field :last_name, 
                  placeholder: "Enter your last name",
                  required: true %>
            </div>
          </div>

          <div>
            <%= form.label :bio, "Bio / About Me" %>
            <%= form.text_area :bio, rows: 4,
                placeholder: "Tell us a bit about yourself..." %>
            <div class="help-text">This helps other users get to know you better.</div>
          </div>

          <div>
            <%= form.label :phone, "Phone Number" %>
            <%= form.text_field :phone, 
                placeholder: "(555) 123-4567" %>
            <div class="help-text">Optional - for easier contact when returning items.</div>
          </div>
        </div>

        <!-- Profile Photo -->
        <div class="form-section">
          <h3>üì∏ Profile Photo</h3>
          
          <% if @user.profile_photo.attached? %>
            <div style="margin-bottom: 20px;">
              <p><strong>Current Photo:</strong></p>
              <%= image_tag @user.profile_photo, style: "width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 2px solid #2E5BBA;" %>
            </div>
          <% end %>
          
          <div>
            <%= form.label :profile_photo, "Upload Profile Photo" %>
            <%= form.file_field :profile_photo, 
                accept: "image/*",
                class: "form-control" %>
            <div class="help-text">Upload a photo from your device. Supported formats: JPG, PNG, GIF</div>
          </div>
        </div>

        <!-- Contact Preferences -->
        <div class="form-section">
          <h3>üìû Contact Preferences</h3>
          
          <div>
            <%= form.label :contact_preference, "Preferred Contact Method" %>
            <%= form.select :contact_preference, 
                options_for_select([
                  ['Email', 'email'],
                  ['Phone', 'phone']
                ], @user.contact_preference),
                {},
                class: "form-control" %>
            <div class="help-text">How would you like to be contacted when someone finds your item?</div>
          </div>

          <div>
            <%= form.label :profile_visibility, "Profile Visibility" %>
            <%= form.select :profile_visibility, 
                options_for_select([
                  ['Public - Anyone can see your profile', 'public'],
                  ['Private - Only you can see your profile', 'private']
                ], @user.profile_visibility),
                {},
                class: "form-control" %>
            <div class="help-text">Control who can view your profile information.</div>
          </div>
        </div>

        <!-- Password Section -->
        <div class="form-section">
          <h3>üîí Change Password</h3>
          <div class="help-text">Leave blank if you don't want to change your password.</div>
          
          <div>
            <%= form.label :password, "New Password" %>
            <%= form.password_field :password, 
                placeholder: "Enter new password" %>
          </div>

          <div>
            <%= form.label :password_confirmation, "Confirm New Password" %>
            <%= form.password_field :password_confirmation, 
                placeholder: "Confirm new password" %>
          </div>
        </div>

        <!-- Account Information (Read-only) -->
        <div class="readonly-section">
          <h3>‚ÑπÔ∏è Account Information</h3>
          <div class="form-row">
            <div class="readonly-field">
              <label>Email Address</label>
              <p><%= @user.email %></p>
              <small>Columbia email address (cannot be changed)</small>
            </div>
            <div class="readonly-field">
              <label>UNI</label>
              <p><%= @user.uni.upcase %></p>
              <small>University Network ID (auto-generated)</small>
            </div>
          </div>
          <div class="readonly-field">
            <label>Member Since</label>
            <p><%= @user.created_at.strftime("%B %d, %Y") %></p>
          </div>
        </div>

        <!-- Submit Buttons -->
        <div class="button-group">
          <%= link_to "Cancel", user_path(@user), class: "btn btn-secondary" %>
          <%= form.submit "Update Profile", class: "btn" %>
        </div>
      <% end %>

      <div class="back-link">
        <%= link_to "‚Üê Back to Profile", user_path(@user) %>
      </div>
    </div>
  </body>
</html>